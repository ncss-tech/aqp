<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perturb soil horizon depths using boundary distinctness — perturb • aqp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perturb soil horizon depths using boundary distinctness — perturb"><meta name="description" content='"Perturbs" the boundary between horizons or the thickness of horizons using a standard deviation specified as a horizon-level attribute. This is selected using either boundary.attr or thickness.attr to specify the column name.
The boundary standard deviation corresponds roughly to the concept of "horizon boundary distinctness." In contrast, the horizon thickness standard deviation corresponds roughly to the "variation in horizon thickness" so it may be determined from several similar profiles that have a particular layer "in common."'><meta property="og:description" content='"Perturbs" the boundary between horizons or the thickness of horizons using a standard deviation specified as a horizon-level attribute. This is selected using either boundary.attr or thickness.attr to specify the column name.
The boundary standard deviation corresponds roughly to the concept of "horizon boundary distinctness." In contrast, the horizon thickness standard deviation corresponds roughly to the "variation in horizon thickness" so it may be determined from several similar profiles that have a particular layer "in common."'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">aqp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/aqp-overview.html">An Overview of the aqp Package</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction-to-SoilProfileCollection-Objects.html">Introduction to SoilProfileCollection Objects</a></li>
    <li><a class="dropdown-item" href="../articles/label-placement.html">Overlapping Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/missing-data.html">Missing Data</a></li>
    <li><a class="dropdown-item" href="../articles/Munsell-color-conversion.html">Munsell Color Conversion</a></li>
    <li><a class="dropdown-item" href="../articles/NCSP.html">Numerical Classification of Soil Profiles</a></li>
    <li><a class="dropdown-item" href="../articles/new-in-aqp-2.html">What is new in aqp 2.x?</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncss-tech/aqp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perturb soil horizon depths using boundary distinctness</h1>
      <small class="dont-index">Source: <a href="https://github.com/ncss-tech/aqp/blob/master/R/perturb.R" class="external-link"><code>R/perturb.R</code></a></small>
      <div class="d-none name"><code>perturb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>"Perturbs" the <strong>boundary between horizons</strong> or the <strong>thickness of horizons</strong> using a standard deviation specified as a horizon-level attribute. This is selected using either <code>boundary.attr</code> or <code>thickness.attr</code> to specify the column name.</p>
<p>The boundary standard deviation corresponds roughly to the concept of "horizon boundary distinctness." In contrast, the <em>horizon thickness</em> standard deviation corresponds roughly to the "variation in horizon thickness" so it may be determined from several similar profiles that have a particular layer "in common."</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">perturb</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thickness.attr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boundary.attr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min.thickness <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max.depth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  new.idname <span class="op">=</span> <span class="st">"pID"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>A SoilProfileCollection</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of new profiles to generate (default: <code>100</code>) per profile in <code>p</code></p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>a vector of profile IDs with length equal to (<code>n</code>). Overrides use of <code>seq_len(n)</code> as default profile ID values.</p></dd>


<dt id="arg-thickness-attr">thickness.attr<a class="anchor" aria-label="anchor" href="#arg-thickness-attr"></a></dt>
<dd><p>Horizon variance attribute containing numeric "standard deviations" reflecting horizon thickness</p></dd>


<dt id="arg-boundary-attr">boundary.attr<a class="anchor" aria-label="anchor" href="#arg-boundary-attr"></a></dt>
<dd><p>Horizon variance attribute containing numeric "standard deviations" reflecting boundary transition distinctness</p></dd>


<dt id="arg-min-thickness">min.thickness<a class="anchor" aria-label="anchor" href="#arg-min-thickness"></a></dt>
<dd><p>Minimum thickness of permuted horizons (default: <code>1</code>)</p></dd>


<dt id="arg-max-depth">max.depth<a class="anchor" aria-label="anchor" href="#arg-max-depth"></a></dt>
<dd><p>Depth below which horizon depths are not perturbed (default: <code>NULL</code>)</p></dd>


<dt id="arg-new-idname">new.idname<a class="anchor" aria-label="anchor" href="#arg-new-idname"></a></dt>
<dd><p>New column name to contain unique profile ID (default: <code>pID</code>)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a SoilProfileCollection with <code>n</code> realizations of each profile in <code>p</code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Imagine a Normal curve with mean centered on the vertical (depth axis) at a representative value (RV) horizon bottom depth or thickness. By the Empirical Rule for Normal distribution, two "standard deviations" above or below that "central" mean value represent 95% of the "typical volume" of that horizon or boundary.</p>
<p><code>perturb()</code> can leverage semi-quantitative (ordered factor) levels of boundary distinctness/topography for the upper and lower boundary of individual horizons. A handy function for this is <code><a href="hzDistinctnessCodeToOffset.html">hzDistinctnessCodeToOffset()</a></code>. The <code>boundary.attr</code> is arguably easier to parameterize from a single profile description or "Form 232" where <em>horizon boundary distinctness</em> classes (based on vertical distance of transition) are conventionally recorded for each layer.</p>
<p>Alternately, <code>perturb()</code> can be parameterized using standard deviation in thickness of layers derived from a group. Say, the variance parameters are defined from a set of pedons correlated to a particular series or component, and the template "seed" profile is, for example, the Official Series Description or the Representative Component Pedon.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="random_profile.html">random_profile()</a></code> <code><a href="hzDistinctnessCodeToOffset.html">hzDistinctnessCodeToOffset()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>D.E. Beaudette, A.G. Brown</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### THICKNESS</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load sample data and convert into SoilProfileCollection</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sp3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="depths.html">depths</a></span><span class="op">(</span><span class="va">sp3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">id</span> <span class="op">~</span> <span class="va">top</span> <span class="op">+</span> <span class="va">bottom</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># select a profile to use as the basis for simulation</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="va">sp3</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reset horizon names</span></span></span>
<span class="r-in"><span><span class="va">s</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'H'</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate 25 new profiles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="horizons.html">horizons</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">$</span><span class="va">hz.sd</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># constant standard deviation</span></span></span>
<span class="r-in"><span><span class="va">sim.1</span> <span class="op">&lt;-</span> <span class="fu">perturb</span><span class="op">(</span><span class="va">s</span>, n <span class="op">=</span> <span class="fl">25</span>, thickness.attr <span class="op">=</span> <span class="st">"hz.sd"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate 25 new profiles using different SD for each horizon</span></span></span>
<span class="r-in"><span><span class="fu"><a href="horizons.html">horizons</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">$</span><span class="va">hz.sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim.2</span> <span class="op">&lt;-</span> <span class="fu">perturb</span><span class="op">(</span><span class="va">s</span>, n <span class="op">=</span> <span class="fl">25</span>, thickness.attr <span class="op">=</span> <span class="st">"hz.sd"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="SoilProfileCollection-plotting-methods.html">plot</a></span><span class="op">(</span><span class="va">sim.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'SD = 2'</span>,</span></span>
<span class="r-in"><span>  side <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  line <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>  font <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  cex <span class="op">=</span> <span class="fl">0.75</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="SoilProfileCollection-plotting-methods.html">plot</a></span><span class="op">(</span><span class="va">sim.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'SD = c(1, 2, 5, 5, 5, 10, 3)'</span>,</span></span>
<span class="r-in"><span>  side <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  line <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>  font <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  cex <span class="op">=</span> <span class="fl">0.75</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="perturb-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># aggregate horizonation of simulated data</span></span></span>
<span class="r-in"><span><span class="co"># note: set class_prob_mode=2 as profiles were not defined to a constant depth</span></span></span>
<span class="r-in"><span><span class="va">sim.2</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sim.2</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="slab.html">slab</a></span><span class="op">(</span><span class="va">sim.2</span>, <span class="op">~</span> <span class="va">name</span>, cpm<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># convert to long format for plotting simplicity</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a.long</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               id.vars <span class="op">=</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="st">'top'</span>, <span class="st">'bottom'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">sim.2</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot horizon probabilities derived from simulated data</span></span></span>
<span class="r-in"><span><span class="co"># dashed lines are the original horizon boundaries</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">top</span> <span class="op">~</span> <span class="va">value</span>,</span></span>
<span class="r-in"><span>  groups <span class="op">=</span> <span class="va">variable</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">a.long</span>,</span></span>
<span class="r-in"><span>  subset <span class="op">=</span> <span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  ylim <span class="op">=</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="op">-</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="st">'l'</span>, <span class="st">'g'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  asp <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">'Depth (cm)'</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">'Probability'</span>,</span></span>
<span class="r-in"><span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    columns <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    lines <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    points <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  panel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.xyplot.html" class="external-link">panel.xyplot</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html" class="external-link">panel.abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">s</span><span class="op">$</span><span class="va">top</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="perturb-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### BOUNDARIES</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example with sp1 (using boundary distinctness)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sp1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="depths.html">depths</a></span><span class="op">(</span><span class="va">sp1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">id</span> <span class="op">~</span> <span class="va">top</span> <span class="op">+</span> <span class="va">bottom</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify "standard deviation" for boundary thickness</span></span></span>
<span class="r-in"><span><span class="co">#   consider a normal curve centered at boundary RV depth</span></span></span>
<span class="r-in"><span><span class="co"># lookup table: ~maximum thickness of boundary distinctness classes, divided by 3</span></span></span>
<span class="r-in"><span><span class="va">bound.lut</span> <span class="op">&lt;-</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="st">'V'</span><span class="op">=</span><span class="fl">0.5</span>,<span class="st">'A'</span><span class="op">=</span><span class="fl">2</span>,<span class="st">'C'</span><span class="op">=</span><span class="fl">5</span>,<span class="st">'G'</span><span class="op">=</span><span class="fl">15</span>,<span class="st">'D'</span><span class="op">=</span><span class="fl">45</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## V          A          C          G          D</span></span></span>
<span class="r-in"><span><span class="co">## 0.1666667  0.6666667  1.6666667  5.0000000 15.0000000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sp1</span><span class="op">$</span><span class="va">bound_sd</span> <span class="op">&lt;-</span> <span class="va">bound.lut</span><span class="op">[</span><span class="va">sp1</span><span class="op">$</span><span class="va">bound_distinct</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># hold any NA boundary distinctness constant</span></span></span>
<span class="r-in"><span><span class="va">sp1</span><span class="op">$</span><span class="va">bound_sd</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sp1</span><span class="op">$</span><span class="va">bound_sd</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">sp1</span><span class="op">$</span><span class="va">bound_sd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0%       25%       50%       75%      100% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0000000 0.0000000 0.6666667 0.6666667 1.6666667 </span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">sp1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># assume boundary sd is 1/12 midpoint of horizon depth</span></span></span>
<span class="r-in"><span><span class="co"># (i.e. general relationship: SD increases (less well known) with depth)</span></span></span>
<span class="r-in"><span><span class="va">sp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">sp1</span>, midpt <span class="op">=</span> <span class="op">(</span><span class="va">bottom</span> <span class="op">-</span> <span class="va">top</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">top</span>, bound_sd <span class="op">=</span> <span class="va">midpt</span> <span class="op">/</span> <span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">sp1</span><span class="op">$</span><span class="va">bound_sd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          0%         25%         50%         75%        100% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.08333333  0.92708333  3.75000000  9.25000000 19.41666667 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">perturb</span><span class="op">(</span><span class="va">p</span>, boundary.attr <span class="op">=</span> <span class="st">"bound_sd"</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SoilProfileCollection with 10 profiles and 50 horizons</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> profile ID: id  |  horizon ID: hzID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Depth range: 64 - 70 cm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----- Horizons (6 / 50 rows  |  10 / 20 columns) -----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       id hzID top bottom group bound_distinct bound_topography name texture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-01    1   0      2     2              C                W Oa/A      SL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-01    2   2     15     2              G                S   AB     SCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-01    3  15     34     2              G                S   BA     SCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-01    4  34     54     2              C                S  Bt1  GRVSCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-01    5  54     67     2              G                S  Bt2    GRVC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-02    6   0      2     2              C                W Oa/A      SL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  prop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [... more horizons ...]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----- Sites (6 / 10 rows  |  2 / 2 columns) -----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       id .oldID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-01   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-02   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-03   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-04   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-05   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-06   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [... more sites ...]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [EMPTY]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Custom IDs</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s-%03d"</span>, <span class="fu"><a href="profile_id.html">profile_id</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu">perturb</span><span class="op">(</span><span class="va">p</span>, boundary.attr <span class="op">=</span> <span class="st">"bound_sd"</span>, id <span class="op">=</span> <span class="va">ids</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SoilProfileCollection with 10 profiles and 50 horizons</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> profile ID: id  |  horizon ID: hzID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Depth range: 65 - 69 cm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----- Horizons (6 / 50 rows  |  10 / 20 columns) -----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id hzID top bottom group bound_distinct bound_topography name texture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-001    1   0      2     2              C                W Oa/A      SL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-001    2   2     14     2              G                S   AB     SCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-001    3  14     36     2              G                S   BA     SCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-001    4  36     52     2              C                S  Bt1  GRVSCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-001    5  52     68     2              G                S  Bt2    GRVC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-002    6   0      3     2              C                W Oa/A      SL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  prop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [... more horizons ...]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----- Sites (6 / 10 rows  |  2 / 2 columns) -----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id .oldID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-001   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-002   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-003   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-004   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-005   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P003-006   P003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [... more sites ...]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [EMPTY]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dylan Beaudette, Pierre Roudier, Andrew Brown, Stephen Roecker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

