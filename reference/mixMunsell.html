<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Mix Munsell Colors via Spectral Library — mixMunsell • aqp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mix Munsell Colors via Spectral Library — mixMunsell"><meta name="description" content="Simulate mixing of colors in Munsell notation, similar to the way in which mixtures of pigments operate."><meta property="og:description" content="Simulate mixing of colors in Munsell notation, similar to the way in which mixtures of pigments operate."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">aqp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/aqp-overview.html">An Overview of the aqp Package</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction-to-SoilProfileCollection-Objects.html">Introduction to SoilProfileCollection Objects</a></li>
    <li><a class="dropdown-item" href="../articles/label-placement.html">Overlapping Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/missing-data.html">Missing Data</a></li>
    <li><a class="dropdown-item" href="../articles/Munsell-color-conversion.html">Munsell Color Conversion</a></li>
    <li><a class="dropdown-item" href="../articles/NCSP.html">Numerical Classification of Soil Profiles</a></li>
    <li><a class="dropdown-item" href="../articles/new-in-aqp-2.html">What is new in aqp 2.x?</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncss-tech/aqp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mix Munsell Colors via Spectral Library</h1>
      <small class="dont-index">Source: <a href="https://github.com/ncss-tech/aqp/blob/master/R/mixMunsell.R" class="external-link"><code>R/mixMunsell.R</code></a></small>
      <div class="d-none name"><code>mixMunsell.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate mixing of colors in Munsell notation, similar to the way in which mixtures of pigments operate.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mixMunsell</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, times <span class="op">=</span> <span class="fu"><a href="length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  mixingMethod <span class="op">=</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="st">"exact"</span>, <span class="st">"reference"</span>, <span class="st">"estimate"</span>, <span class="st">"adaptive"</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  keepMixedSpec <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  distThreshold <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>vector of colors in Munsell notation</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>vector of proportions, can sum to any number</p></dd>


<dt id="arg-mixingmethod">mixingMethod<a class="anchor" aria-label="anchor" href="#arg-mixingmethod"></a></dt>
<dd><p>approach used to simulate a mixture:</p><ul><li><p><code>exact</code>: simulate a subtractive mixture of pigments, color conversion via CIE1931 color-matching functions (see details)</p></li>
<li><p><code>reference</code>: simulate a subtractive mixture of pigments, selecting <code>n</code> closest reference spectra from <code><a href="munsell.spectra.html">munsell.spectra.wide</a></code> (requires <code>gower</code> package)</p></li>
<li><p><code>estimate</code>: closest Munsell chip to a weighted mean of CIELAB coordinates (fastest)</p></li>
<li><p><code>adaptive</code>: use <code>exact</code> method when possible, falling-back to <code>estimate</code> (weighted mean of CIELAB coordinates) otherwise</p></li>
</ul></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of closest matching color chips (<code>mixingMethod = reference</code> only)</p></dd>


<dt id="arg-keepmixedspec">keepMixedSpec<a class="anchor" aria-label="anchor" href="#arg-keepmixedspec"></a></dt>
<dd><p>keep weighted geometric mean spectra, final result is a <code>list</code> (<code>mixingMethod = reference</code> only)</p></dd>


<dt id="arg-distthreshold">distThreshold<a class="anchor" aria-label="anchor" href="#arg-distthreshold"></a></dt>
<dd><p>spectral distance used to compute <code>scaledDistance</code>, default value is based on an analysis of spectral distances associated with adjacent Munsell color chips. This argument is only used with  <code>mixingMethod = 'reference'</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to <code><a href="spec2Munsell.html">spec2Munsell</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> with the closest matching Munsell color(s):</p><ul><li><p><code>munsell</code>: Munsell notation of the n-closest spectra</p></li>
<li><p><code>distance</code>: spectral (Gower) distance to the n-closest spectra</p></li>
<li><p><code>scaledDistance</code>: spectral distance scaled by <code>distThreshold</code></p></li>
<li><p><code>mixingMethod</code>: method used for each mixture</p></li>
</ul><p>When <code>keepMixedSpec = TRUE</code> then a <code>list</code>:</p><ul><li><p><code>mixed</code>: a <code>data.frame</code> containing the same elements as above</p></li>
<li><p><code>spec</code>: spectra for the 1st closest match</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See the <a href="https://ncss-tech.github.io/AQP/aqp/mix-colors.html" class="external-link">expanded tutorial</a> for examples.</p>
<p>An accurate simulation of pigment mixtures ("subtractive" color mixtures) is incredibly complex due to factors that aren't easily measured or controlled: pigment solubility, pigment particle size distribution, water content, substrate composition, and physical obstruction to name a few. That said, it is possible to simulate reasonable, subtractive color mixtures given a reference spectra library (350-800nm) and some assumptions about pigment qualities and lighting. For the purposes of estimating a mixture of soil colors (these are pigments after all) we can relax these assumptions and assume a standard light source. The only missing piece is the spectral library for all Munsell chips in our color books.</p>
<p>Thankfully, <a href="https://arxiv.org/ftp/arxiv/papers/1710/1710.06364.pdf" class="external-link">Scott Burns has outlined the entire process</a>, and Paul Centore has provided a Munsell color chip reflectance spectra library (http://www.munsellcolourscienceforpainters.com). The estimation of a subtractive mixture of soil colors can proceed as follows:</p><ol><li><p>look up the associated spectra for each color in <code>x</code></p></li>
<li><p>compute the weighted (<code>w</code> argument) geometric mean of the spectra</p></li>
<li><p>convert the spectral mixture to the closest Munsell color via:</p></li>
</ol><ul><li><p>search for the closest <code>n</code> matching spectra in the reference library (<code>mixtureMethod = 'reference'</code>)</p></li>
<li><p>direct conversion of spectra to closest Munsell color via <code><a href="spec2Munsell.html">spec2Munsell()</a></code> (<code>mixtureMethod = 'exact'</code>)</p></li>
</ul><ol><li><p>suggest resulting Munsell chip(s) as the best candidate for a simulated mixture</p></li>
</ol><p>Key assumptions include:</p><ul><li><p>similar particle size distribution</p></li>
<li><p>similar mineralogy (i.e. pigmentation qualities)</p></li>
<li><p>similar water content.</p></li>
</ul><p>For the purposes of estimating (for example) a "mixed soil color within the top 18cm of soil" these assumptions are usually valid. Again, these are estimates that are ultimately "snapped" to the nearest chip and not do not need to approach the accuracy of paint-matching systems.</p>
<p>A message is printed when <code>scaledDistance</code> is larger than 1.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Marcus, R.T. (1998). The Measurement of Color. In K. Nassau (Ed.), Color for Science, Art, and Technology (pp. 32-96). North-Holland.</p><ul><li><p><a href="https://arxiv.org/ftp/arxiv/papers/1710/1710.06364.pdf" class="external-link">inspiration / calculations based on the work of Scott Burns</a></p></li>
<li><p><a href="https://stackoverflow.com/questions/10254022/implementing-kubelka-munk-like-krita-to-mix-colours-color-like-paint/29967630#29967630" class="external-link">related discussion on Stack Overflow</a></p></li>
<li><p>spectral library source: http://www.munsellcolourscienceforpainters.com/MunsellResources/SpectralReflectancesOf2007MunsellBookOfColorGlossy.txt</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="munsell.spectra.html">munsell.spectra</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>D.E. Beaudette</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dylan Beaudette, Pierre Roudier, Andrew Brown, Stephen Roecker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

