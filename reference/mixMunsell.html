<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Mix Munsell Colors via Spectral Library — mixMunsell • aqp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Mix Munsell Colors via Spectral Library — mixMunsell"><meta property="og:description" content="Simulate mixing of colors in Munsell notation, similar to the way in which mixtures of pigments operate."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aqp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.43</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Introduction-to-SoilProfileCollection-Objects.html">Introduction to SoilProfileCollection Objects</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ncss-tech/aqp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mix Munsell Colors via Spectral Library</h1>
    <small class="dont-index">Source: <a href="https://github.com/ncss-tech/aqp/blob/HEAD/R/mixMunsell.R" class="external-link"><code>R/mixMunsell.R</code></a></small>
    <div class="hidden name"><code>mixMunsell.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate mixing of colors in Munsell notation, similar to the way in which mixtures of pigments operate.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">mixMunsell</span><span class="op">(</span>
  <span class="va">x</span>,
  w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, times <span class="op">=</span> <span class="fu"><a href="length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
  mixingMethod <span class="op">=</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="st">"reference"</span>, <span class="st">"exact"</span>, <span class="st">"estimate"</span>, <span class="st">"adaptive"</span>, <span class="st">"spectra"</span><span class="op">)</span>,
  n <span class="op">=</span> <span class="fl">1</span>,
  keepMixedSpec <span class="op">=</span> <span class="cn">FALSE</span>,
  distThreshold <span class="op">=</span> <span class="fl">0.025</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>vector of colors in Munsell notation</p></dd>
<dt>w</dt>
<dd><p>vector of proportions, can sum to any number</p></dd>
<dt>mixingMethod</dt>
<dd><p>approach used to simulate a mixture:</p><ul><li><p><code>reference</code>  : simulate a subtractive mixture of pigments, selecting <code>n</code> closest reference spectra from <code><a href="munsell.spectra.html">munsell.spectra.wide</a></code></p></li>
<li><p><code>exact</code>: simulate a subtractive mixture of pigments, color conversion via CIE1931 color-matching functions (see details)</p></li>
<li><p><code>estimate</code> : closest Munsell chip to a weighted mean of CIELAB coordinates</p></li>
<li><p><code>adaptive</code> : use reference spectra when possible, falling-back to weighted mean of CIELAB coordinates</p></li>
</ul></dd>
<dt>n</dt>
<dd><p>number of closest matching color chips (<code>mixingMethod = reference</code> only)</p></dd>
<dt>keepMixedSpec</dt>
<dd><p>keep weighted geometric mean spectra, final result is a <code>list</code> (<code>mixingMethod = reference</code> only)</p></dd>
<dt>distThreshold</dt>
<dd><p>spectral distance used to compute <code>scaledDistance</code>, default value is based on an analysis of spectral distances associated with adjacent Munsell color chips. This argument is only used with  <code>mixingMethod = 'reference'</code>.</p></dd>
<dt>...</dt>
<dd><p>additional arguments to <code><a href="spec2Munsell.html">spec2Munsell</a></code></p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>data.frame</code> with the closest matching Munsell color(s):</p><ul><li><p><code>munsell</code>: Munsell notation of the n-closest spectra</p></li>
<li><p><code>distance</code>: spectral (Gower) distance to the n-closest spectra</p></li>
<li><p><code>scaledDistance</code>: spectral distance scaled by <code>distThreshold</code></p></li>
<li><p><code>mixingMethod</code>: method used for each mixture</p></li>
</ul><p>When <code>keepMixedSpec = TRUE</code> then a <code>list</code>:</p><ul><li><p><code>mixed</code>: a <code>data.frame</code> containing the same elements as above</p></li>
<li><p><code>spec</code>: spectra for the 1st closest match</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>An accurate simulation of pigment mixtures ("subtractive" color mixtures) is incredibly complex due to factors that aren't easily measured or controlled: pigment solubility, pigment particle size distribution, water content, substrate composition, and physical obstruction to name a few. That said, it is possible to simulate reasonable, subtractive color mixtures given a reference spectra library (350-800nm) and some assumptions about pigment qualities and lighting. For the purposes of estimating a mixture of soil colors (these are pigments after all) we can relax these assumptions and assume a standard light source. The only missing piece is the spectral library for all Munsell chips in our color books.</p>
<p>Thankfully, <a href="https://arxiv.org/ftp/arxiv/papers/1710/1710.06364.pdf" class="external-link">Scott Burns has outlined the entire process</a>, and Paul Centore has provided a Munsell color chip <a href="https://www.munsellcolourscienceforpainters.com" class="external-link">reflectance spectra library</a>. The estimation of a subtractive mixture of soil colors can proceed as follows:</p><ol><li><p>look up the associated spectra for each color in <code>x</code></p></li>
<li><p>compute the weighted (<code>w</code> argument) geometric mean of the spectra</p></li>
<li><p>convert the spectral mixture to the closest Munsell color via:</p></li>
</ol><ul><li><p>search for the closest <code>n</code> matching spectra in the reference library (<code>mixtureMethod = 'reference'</code>)</p></li>
<li><p>direct conversion of spectra to closest Munsell color via <code><a href="spec2Munsell.html">spec2Munsell</a></code> ( (<code>mixtureMethod = 'exact'</code>))</p></li>
</ul><ol><li><p>suggest resulting Munsell chip(s) as the best candidate for a simulated mixture</p></li>
</ol><p>Key assumptions include:</p><ul><li><p>similar particle size distribution</p></li>
<li><p>similar mineralogy (i.e. pigmentation qualities)</p></li>
<li><p>similar water content.</p></li>
</ul><p>For the purposes of estimating (for example) a "mixed soil color within the top 18cm of soil" these assumptions are usually valid. Again, these are estimates that are ultimately "snapped" to the nearest chip and not do not need to approach the accuracy of paint-matching systems.</p>
<p>A message is printed when <code>scaledDistance</code> is larger than 1.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Marcus, R.T. (1998). The Measurement of Color. In K. Nassau (Ed.), Color for Science, Art, and Technology (pp. 32-96). North-Holland.</p>
<ul><li><p>inspiration / calculations based on the work of Scott Burns: <a href="https://arxiv.org/ftp/arxiv/papers/1710/1710.06364.pdf" class="external-link">https://arxiv.org/ftp/arxiv/papers/1710/1710.06364.pdf</a></p></li>
<li><p>related discussion on Stack Overflow: <a href="https://stackoverflow.com/questions/10254022/implementing-kubelka-munk-like-krita-to-mix-colours-color-like-paint/29967630#29967630" class="external-link">https://stackoverflow.com/questions/10254022/implementing-kubelka-munk-like-krita-to-mix-colours-color-like-paint/29967630#29967630</a></p></li>
<li><p>spectral library source: <a href="https://www.munsellcolourscienceforpainters.com/MunsellResources/SpectralReflectancesOf2007MunsellBookOfColorGlossy.txt" class="external-link">https://www.munsellcolourscienceforpainters.com/MunsellResources/SpectralReflectancesOf2007MunsellBookOfColorGlossy.txt</a></p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="munsell.spectra.html">munsell.spectra</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>D.E. Beaudette</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># try a couple different methods</span></span>
<span class="r-in"><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="st">'10YR 6/2'</span>, <span class="st">'5YR 5/6'</span>, <span class="st">'10B 4/4'</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">mixMunsell</span><span class="op">(</span><span class="va">cols</span>, mixingMethod <span class="op">=</span> <span class="st">'reference'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   munsell   distance scaledDistance distanceMetric mixingMethod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  5Y 5/1 0.01311294      0.5245176          Gower    reference</span>
<span class="r-in"><span class="fu">mixMunsell</span><span class="op">(</span><span class="va">cols</span>, mixingMethod <span class="op">=</span> <span class="st">'exact'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    munsell distance scaledDistance distanceMetric mixingMethod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 10YR 5/1 1.670085             NA           dE00        exact</span>
<span class="r-in"><span class="fu">mixMunsell</span><span class="op">(</span><span class="va">cols</span>, mixingMethod <span class="op">=</span> <span class="st">'estimate'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     munsell distance scaledDistance distanceMetric mixingMethod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 7.5YR 5/2 1.241368             NA           dE00     estimate</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># 2.5 values</span></span>
<span class="r-in"><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="st">'10YR 2.5/2'</span>, <span class="st">'5YR 5/6'</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">mixMunsell</span><span class="op">(</span><span class="va">cols</span>, mixingMethod <span class="op">=</span> <span class="st">'reference'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   munsell   distance scaledDistance distanceMetric mixingMethod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  5Y 4/3 0.01107466      0.4429862          Gower    reference</span>
<span class="r-in"><span class="fu">mixMunsell</span><span class="op">(</span><span class="va">cols</span>, mixingMethod <span class="op">=</span> <span class="st">'exact'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     munsell distance scaledDistance distanceMetric mixingMethod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 7.5YR 4/3 3.469518             NA           dE00        exact</span>
<span class="r-in"><span class="fu">mixMunsell</span><span class="op">(</span><span class="va">cols</span>, mixingMethod <span class="op">=</span> <span class="st">'estimate'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     munsell distance scaledDistance distanceMetric mixingMethod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 7.5YR 4/4 2.463059             NA           dE00     estimate</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dylan Beaudette, Pierre Roudier, Andrew Brown.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

