<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Collapse Horizons within Profiles Based on Pattern Matching — collapseHz • aqp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Collapse Horizons within Profiles Based on Pattern Matching — collapseHz"><meta name="description" content="Combines layers and aggregates data by grouping adjacent horizons which match pattern in
hzdesgn or, alternately, share a common value in by argument. Numeric properties are combined
using the weighted average, and other properties are derived from the dominant condition based on
thickness of layers and values in each group."><meta property="og:description" content="Combines layers and aggregates data by grouping adjacent horizons which match pattern in
hzdesgn or, alternately, share a common value in by argument. Numeric properties are combined
using the weighted average, and other properties are derived from the dominant condition based on
thickness of layers and values in each group."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">aqp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/aqp-overview.html">An Overview of the aqp Package</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction-to-SoilProfileCollection-Objects.html">Introduction to SoilProfileCollection Objects</a></li>
    <li><a class="dropdown-item" href="../articles/label-placement.html">Overlapping Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/missing-data.html">Missing Data</a></li>
    <li><a class="dropdown-item" href="../articles/Munsell-color-conversion.html">Munsell Color Conversion</a></li>
    <li><a class="dropdown-item" href="../articles/NCSP.html">Numerical Classification of Soil Profiles</a></li>
    <li><a class="dropdown-item" href="../articles/new-in-aqp-2.html">What is new in aqp 2.x?</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncss-tech/aqp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Collapse Horizons within Profiles Based on Pattern Matching</h1>
      <small class="dont-index">Source: <a href="https://github.com/ncss-tech/aqp/blob/master/R/collapseHz.R" class="external-link"><code>R/collapseHz.R</code></a></small>
      <div class="d-none name"><code>collapseHz.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Combines layers and aggregates data by grouping adjacent horizons which match <code>pattern</code> in
<code>hzdesgn</code> or, alternately, share a common value in <code>by</code> argument. Numeric properties are combined
using the weighted average, and other properties are derived from the dominant condition based on
thickness of layers and values in each group.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">collapseHz</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hzdesgn <span class="op">=</span> <span class="fu"><a href="hzdesgnname.html">hzdesgnname</a></span><span class="op">(</span><span class="va">x</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">pattern</span>, <span class="va">hzdesgn</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">pattern</span>, <span class="va">x</span><span class="op">[[</span><span class="va">hzdesgn</span><span class="op">]</span><span class="op">]</span>, ignore.case <span class="op">=</span></span>
<span>    <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  AGGFUN <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ignore_numerics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <em>SoilProfileCollection</em></p></dd>


<dt id="arg-pattern">pattern<a class="anchor" aria-label="anchor" href="#arg-pattern"></a></dt>
<dd><p><em>character</em>. A regular expression pattern to match in <code>hzdesgn</code> column. Default:
<code>NULL</code>.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p><em>character</em>. A column name specifying horizons that should be combined. Aggregation
will be applied to adjacent groups of layers within profiles that have the same value in <code>by</code>.
Used in lieu of <code>pattern</code> and <code>hzdesgn</code>. Default: <code>NULL</code>.</p></dd>


<dt id="arg-hzdesgn">hzdesgn<a class="anchor" aria-label="anchor" href="#arg-hzdesgn"></a></dt>
<dd><p><em>character</em>. Any character column containing horizon-level identifiers. Default:
<code>hzdesgnname(x, required = TRUE)</code>.</p></dd>


<dt id="arg-fun">FUN<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p><em>function</em>. A function that returns a <em>logical</em> vector equal in length to the number
of horizons in <code>x</code>. Used only when <code>pattern</code> is specified. See details.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to the matching function <code>FUN</code>.</p></dd>


<dt id="arg-aggfun">AGGFUN<a class="anchor" aria-label="anchor" href="#arg-aggfun"></a></dt>
<dd><p><em>list</em>. A <em>named</em> list containing custom aggregation functions. List element names
should match the column name that they transform. The functions defined should take three
arguments: <code>x</code> (a vector of horizon property values), <code>top</code> (a vector of top depths), and
<code>bottom</code> (a vector of bottom depths). Default: <code>NULL</code> applies <code><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean()</a></code> to all numeric
columns not listed in <code>ignore_numerics</code> and takes the dominant condition (value with greatest
aggregate thickness sum) for all other columns. See details.</p></dd>


<dt id="arg-ignore-numerics">ignore_numerics<a class="anchor" aria-label="anchor" href="#arg-ignore-numerics"></a></dt>
<dd><p><em>character</em>. Vector of column names that contain numeric values which
should <em>not</em> be aggregated using <code><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean()</a></code>. For example, soil color "value" and
"chroma".</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p><em>logical</em>. If <code>TRUE</code> <code>NA</code> values are ignored when calculating min/max boundaries for
each group and in weighted averages. If <code>FALSE</code> <code>NA</code> values are propagated to the result.
Default: <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <em>SoilProfileCollection</em></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If a custom matching function (<code>FUN</code>) is used, it should accept arbitrary additional arguments
via an ellipsis (<code>...</code>). It is not necessary to do anything with arguments, but the result should
match the number of horizons found in the input SoilProfileCollection <code>x</code>.</p>
<p>Custom aggregation functions defined in the <code>AGGFUN</code> argument should either return a single
vector value for each group*column combination, or should return a <em>data.frame</em> object with named
columns. If the input column name is used as a column name in the result <em>data.frame</em>, then the
values of that column name in the result <em>SoilProfileCollection</em> will be replaced by the output
of the aggregation function. See examples.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="hz_dissolve.html">hz_dissolve()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Andrew G. Brown</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">jacobs2000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate a new SPC with genhz column based on patterns</span></span></span>
<span class="r-in"><span><span class="va">new_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"E"</span>, <span class="st">"Bt"</span>, <span class="st">"Bh"</span>, <span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">patterns</span> <span class="op">&lt;-</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"E"</span>, <span class="st">"B.*t"</span>, <span class="st">"B.*h"</span>, <span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">jacobs2000_gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="generalize.hz.html">generalizeHz</a></span><span class="op">(</span><span class="va">jacobs2000</span>, new <span class="op">=</span> <span class="va">new_labels</span>, pattern <span class="op">=</span> <span class="va">patterns</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use existing generalized horizon labels</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu">collapseHz</span><span class="op">(</span><span class="va">jacobs2000_gen</span>, by <span class="op">=</span> <span class="st">"genhz"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="profile_id.html">profile_id</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="profile_id.html">profile_id</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, <span class="st">"_collapse"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="SoilProfileCollection-plotting-methods.html">plot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">jacobs2000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  color <span class="op">=</span> <span class="st">"genhz"</span>,</span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">"name"</span>,</span></span>
<span class="r-in"><span>  name.style <span class="op">=</span> <span class="st">"center-center"</span>,</span></span>
<span class="r-in"><span>  cex.names <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="collapseHz-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># custom pattern argument  </span></span></span>
<span class="r-in"><span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fu">collapseHz</span><span class="op">(</span><span class="va">jacobs2000</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                  `A` <span class="op">=</span> <span class="st">"^A"</span>,</span></span>
<span class="r-in"><span>                  `E` <span class="op">=</span> <span class="st">"E"</span>,</span></span>
<span class="r-in"><span>                  `Bt` <span class="op">=</span> <span class="st">"[ABC]+t"</span>,</span></span>
<span class="r-in"><span>                  `C` <span class="op">=</span> <span class="st">"^C"</span>,</span></span>
<span class="r-in"><span>                  `foo` <span class="op">=</span> <span class="st">"bar"</span></span></span>
<span class="r-in"><span>                <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="profile_id.html">profile_id</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="profile_id.html">profile_id</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span>, <span class="st">"_collapse"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="SoilProfileCollection-plotting-methods.html">plot</a></span><span class="op">(</span><span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span><span class="va">j</span>, <span class="va">jacobs2000</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"clay"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="collapseHz-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># custom aggregation function for matrix_color_munsell</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu">collapseHz</span><span class="op">(</span><span class="va">jacobs2000</span>,</span></span>
<span class="r-in"><span>                pattern <span class="op">=</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                  `A` <span class="op">=</span> <span class="st">"^A"</span>,</span></span>
<span class="r-in"><span>                  `E` <span class="op">=</span> <span class="st">"E"</span>,</span></span>
<span class="r-in"><span>                  `Bt` <span class="op">=</span> <span class="st">"[ABC]+t"</span>,</span></span>
<span class="r-in"><span>                  `C` <span class="op">=</span> <span class="st">"^C"</span>,</span></span>
<span class="r-in"><span>                  `foo` <span class="op">=</span> <span class="st">"bar"</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>                AGGFUN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                  matrix_color_munsell <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">top</span>, <span class="va">bottom</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                    <span class="va">thk</span> <span class="op">&lt;-</span> <span class="va">bottom</span> <span class="op">-</span> <span class="va">top</span></span></span>
<span class="r-in"><span>                    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                      <span class="va">xord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">thk</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>                      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">xord</span><span class="op">]</span>, <span class="st">" (t="</span>, <span class="va">thk</span><span class="op">[</span><span class="va">xord</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="op">}</span> <span class="kw">else</span></span></span>
<span class="r-in"><span>                      <span class="va">x</span></span></span>
<span class="r-in"><span>                  <span class="op">}</span></span></span>
<span class="r-in"><span>                <span class="op">)</span></span></span>
<span class="r-in"><span>              <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="profile_id.html">profile_id</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="profile_id.html">profile_id</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span>, <span class="st">"_collapse_custom"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="unique.html">unique</a></span><span class="op">(</span><span class="va">k</span><span class="op">$</span><span class="va">matrix_color_munsell</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "10YR 4/1"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] "2.5Y 6/6"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "10YR 6/8 (t=51), 10YR 5/8 (t=36), 10YR 6/8 (t=23)"                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4] NA                                                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "2.5YR 4/8"                                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "10YR 2/2"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "10YR 6/4"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] "10YR 5/8 (t=38), 10YR 6/8 (t=38), 10YR 6/8 (t=23)"                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "10YR 4/2 (t=15), 10YR 5/2 (t=10)"                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "10YR 7/4"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "10YR 6/4 (t=53), 10YR 6/4 (t=28), 2.5Y 6/6 (t=20), 10YR 7/2 (t=10)"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12] "10YR 5/1"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "10YR 7/4 (t=51), 10YR 8/1 (t=35), 10YR 6/4 (t=33), 10YR 7/4 (t=26), 2.5Y 8/2 (t=20)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14] "10YR 7/2"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "10YR 5/2"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] "2.5Y 7/3 (t=48), 2.5Y 7/4 (t=33)"                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "10YR 6/6"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18] "10YR 4/6"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "2.5Y 6/3 (t=28), 10YR 5/1 (t=18)"                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] "2.5Y 7/3 (t=30), 2.5Y 6/3 (t=28)"                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "10YR 7/1 (t=49), 10YR 7/2 (t=15)"                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] "10YR 8/1"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23] "7.5YR 3/2"                                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24] "10YR 3/2"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "10YR 7/2 (t=41), 10YR 6/3 (t=30)"                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26] "10YR 2/1"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27] "10YR 6/1"                                                                           </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># custom aggregation function for matrix_color_munsell (returns data.frame)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">collapseHz</span><span class="op">(</span><span class="va">jacobs2000</span>,</span></span>
<span class="r-in"><span>                pattern <span class="op">=</span> <span class="fu"><a href="combine-SoilProfileCollection-method.html">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                  `A` <span class="op">=</span> <span class="st">"^A"</span>,</span></span>
<span class="r-in"><span>                  `E` <span class="op">=</span> <span class="st">"E"</span>,</span></span>
<span class="r-in"><span>                  `Bt` <span class="op">=</span> <span class="st">"[ABC]+t"</span>,</span></span>
<span class="r-in"><span>                  `C` <span class="op">=</span> <span class="st">"^C"</span>,</span></span>
<span class="r-in"><span>                  `foo` <span class="op">=</span> <span class="st">"bar"</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>                AGGFUN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                  matrix_color_munsell <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">top</span>, <span class="va">bottom</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                    <span class="va">thk</span> <span class="op">&lt;-</span> <span class="va">bottom</span> <span class="op">-</span> <span class="va">top</span></span></span>
<span class="r-in"><span>                    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                      <span class="va">xord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">thk</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>                      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix_color_munsell <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span>, collapse <span class="op">=</span> <span class="st">";"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 n_matrix_color <span class="op">=</span> <span class="fu"><a href="length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix_color_munsell <span class="op">=</span> <span class="va">x</span>, </span></span>
<span class="r-in"><span>                                 n_matrix_color <span class="op">=</span> <span class="fu"><a href="length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="op">}</span></span></span>
<span class="r-in"><span>                  <span class="op">}</span></span></span>
<span class="r-in"><span>                <span class="op">)</span></span></span>
<span class="r-in"><span>              <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="profile_id.html">profile_id</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="profile_id.html">profile_id</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, <span class="st">"_collapse_custom"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">$</span><span class="va">matrix_color_munsell.n_matrix_color</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] NA   NA   "4"  NA   NA   NA   NA   "10" NA   "2"  NA   "19" NA   "24" NA  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] NA   "30" NA   NA   "2"  "35" "38" NA   NA   NA   NA   "44" NA   NA  </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dylan Beaudette, Pierre Roudier, Andrew Brown, Stephen Roecker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

