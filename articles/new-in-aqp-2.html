<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>What is new in aqp 2.0? • aqp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="What is new in aqp 2.0?">
<meta property="og:description" content="aqp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aqp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction-to-SoilProfileCollection-Objects.html">Introduction to SoilProfileCollection Objects</a>
    </li>
    <li>
      <a href="../articles/NCSP.html">Numerical Classification of Soil Profiles</a>
    </li>
    <li>
      <a href="../articles/label-placement.html">Overlapping Annotation</a>
    </li>
    <li>
      <a href="../articles/new-in-aqp-2.html">What is new in aqp 2.0?</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ncss-tech/aqp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>What is new in aqp 2.0?</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ncss-tech/aqp/blob/HEAD/vignettes/new-in-aqp-2.Rmd" class="external-link"><code>vignettes/new-in-aqp-2.Rmd</code></a></small>
      <div class="hidden name"><code>new-in-aqp-2.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This is a major update to aqp that may create some issues for code
depending on specific inputs/outputs in aqp &lt; 1.42, particularly
those relying on <code><a href="../reference/slice.html">slice()</a></code>, <code><a href="../reference/slab.html">slab()</a></code>, and
<code><a href="../reference/profile_compare.html">profile_compare()</a></code>. <code><a href="../reference/slice.html">slice()</a></code> and
<code><a href="../reference/profile_compare.html">profile_compare()</a></code> are now deprecated, but will continue to
work for the rest of calendar year 2023. There are no plans to maintain
these functions beyond aqp 2.0. The new version of <code><a href="../reference/slab.html">slab()</a></code>
is a drop-in replacement for the previous version of the function.</p>
<p>Notable changes include: * deprecation of <code><a href="../reference/slice.html">slice()</a></code> in
favor of the new, faster, more robust implementation in
<code><a href="../reference/dice-SoilProfileCollection-method.html">dice()</a></code> * complete overhaul of <code><a href="../reference/slab.html">slab()</a></code>, with new
arguments, faster back-end, and weighted aggregation implemented
(finally) * deprecation of <code><a href="../reference/profile_compare.html">profile_compare()</a></code> in favor of
the <code><a href="../reference/NCSP.html">NCSP()</a></code>–a complete overhaul based on Maynard et al.,
2020 - site level attributes now handled by <code><a href="../reference/compareSites.html">compareSites()</a></code>
- variable weights now possible via argument * <code><a href="../reference/perturb.html">perturb()</a></code>
and <code><a href="../reference/estimatePSCS.html">estimatePSCS()</a></code> are now vectorized, and optimized for
larger collections * <code><a href="../reference/mixMunsell.html">mixMunsell()</a></code> now uses
<code>mixingMethod = 'exact'</code> by default for the simulation of
subtractive mixtures * <code>gower</code> package moved to SUGGESTS *
<code><a href="../reference/plotColorMixture.html">plotColorMixture()</a></code> now using grid graphics functions to
determine color swatch geometry and setting overlap detection threshold
* removal of <code>PMS2Munsell()</code> and support data * deprecation
of <code>coordinates()&lt;-</code> and <code>proj4string()&lt;-</code>
in favor of <code>initSpatial()&lt;-</code> * removal of
<code>rruff.sample</code> example XRD patterns *
<code><a href="../reference/get.ml.hz.html">get.ml.hz()</a></code> no longer uses the <code>name</code>
argument</p>
<p>Major changes to <code><a href="../reference/SoilProfileCollection-plotting-methods.html">plotSPC()</a></code>: * The maximum depth range of
the figure is now based on <code>max.depth</code> or
<code>max(x)</code>. This means that sketches generated with aqp 2.x
will generally have less white space at the bottom of the figure. Make
more room for additional annotation or visual effect by setting the
desired depth range with the <code>max.depth</code> argument. * now uses
<code><a href="../reference/electroStatics_1D.html">electroStatics_1D()</a></code> for fixing horizon depth label overlap,
solutions are deterministic and almost always better * better depth axis
interval heuristics (if not specified), varying based on figure depth
range * depth axis adjustments via new argument <code>depth.axis</code>,
logical or list * deprecation of arguments: -
<code>plot.depth.axis</code>: set via <code>depth.axis = TRUE</code>,
<code>depth.axis = FALSE</code>, or customize
<code>depth.axis = list(...)</code> - <code>cex.depth.axis</code>: set
via <code>depth.axis = list(cex = 1)</code> -
<code>axis.line.offset</code>: set via
<code>depth.axis = list(line = -2)</code></p>
<p>New features: * example data, <code>wilson2022</code> * fast
prototyping of SPCs via <code><a href="../reference/quickSPC.html">quickSPC()</a></code> and list / character
templates * re-use arguments to <code><a href="../reference/SoilProfileCollection-plotting-methods.html">plotSPC()</a></code> via
<code>options(.aqp.plotSPC.args = list(...))</code> * coarse fragment
classification via <code><a href="../reference/fragmentSieve.html">fragmentSieve()</a></code> and
<code><a href="../reference/fragmentClasses.html">fragmentClasses()</a></code> * S4
<code>as.data.frame(&lt;SPC&gt;)</code> as shorthand for
<code>as(&lt;SPC&gt;, 'data.frame')</code> * <code><a href="../reference/SoilProfileCollection-plotting-methods.html">plotSPC()</a></code> now
marks truncated profiles with a ragged bottom *
<code><a href="../reference/fixOverlap.html">fixOverlap()</a></code> now has two label-placement solvers, based on
1) electrostatics and 2) simulated annealing * new <a href="https://ncss-tech.github.io/AQP/aqp/sketches.html" class="external-link">depth axis
styles</a> in <code><a href="../reference/SoilProfileCollection-plotting-methods.html">plotSPC()</a></code></p>
<p>Incremental changes, should have no effect on previous code: * bug
fix in <code><a href="../reference/SoilProfileCollection-plotting-methods.html">plotSPC()</a></code> when
<code>fixLabelCollisions = TRUE</code>, adjustments suggested to
<code><a href="../reference/fixOverlap.html">fixOverlap()</a></code> are now scaled correctly *
<code><a href="../reference/explainPlotSPC.html">explainPlotSPC()</a></code> reports label adjustment index when label
collision repair is enabled * aesthetic cleanup in
<code><a href="../reference/explainPlotSPC.html">explainPlotSPC()</a></code> * <code><a href="../reference/soilColorSignature.html">soilColorSignature()</a></code> gains
arguments and perceptual color distances (dE00) via farver package *
<code>as(&lt;SPC&gt;, "data.frame")</code>: Replace
<code><a href="https://rdrr.io/pkg/plyr/man/join.html" class="external-link">plyr::join()</a></code> with <code><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge()</a></code> *
<code><a href="../reference/correctAWC.html">correctAWC()</a></code>: NA handling - return NA when frags are NA *
<code><a href="../reference/mutate_profile.html">mutate_profile()</a></code>: Faster (data.table-based) evaluation of
profile-level expressions (#255) * <code>profileApply</code>: Add
support for custom <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code>-like function
(<code>APPLY.FUN</code>) for processing chunks (#256) * Add
<code>.interpretHorizonColor()</code> outputs to
<code>last_spc_plot</code> in <code>aqp.env</code> for use in custom
<code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend()</a></code> (#254) * Add <code>simplify</code> argument to
<code><a href="../reference/SoilTextureLevels.html">SoilTextureLevels()</a></code> and <code><a href="../reference/texture.html">ssc_to_texcl()</a></code> to
optionally convert to an ordered factor with maximum of 12 levels
(rather than 21). This smaller list of classes excludes sand grain size
variants such as fine sand, loamy coarse sand, and very fine sandy
loam.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dylan Beaudette, Pierre Roudier, Andrew Brown.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
